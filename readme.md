Сапсан 2 - .msi пакет
============================================================

Данный проект - .msi пакет для развёртывания в рамках домена
[программного комплекса для стендов автоматизированных для испытаний и поверки
радиолокационных измерителей скорости Сапсан 2][Сапсан 2].

В настоящий момент в пакет включены следующие продукты:
- Сапсан 2-10М для проведения поверки, испытаний и контроля метрологических
характеристик измерителей скорости, имеющих рабочую частоту 10.5-10.55 ГГц;
- Сапсан 2-24М для проведения поверки, испытаний и контроля метрологических
характеристик измерителей скорости, имеющих рабочую частоту 24.5-24.55 ГГц.

Общие положения
---------------

Данный репозиторий не содержит исходных файлов самого программного продукта, только его дистрибутива
(wix проект для .msi пакета). Разработчик данного .msi пакета не несёт ответственности за
возможные ошибки в функционировании самого программного продукта и не может повлиять на
ограничения самого программного продукта.

Инструменты для сборки .msi пакета
----------------------------------

Для внесения изменений в пакет и повторной сборки пакета потребуются следующие продукты:

- Microsoft Visual Studio 2012 Shell:
	- [MS Visual Studio 2012 Shell Isolated][]
	- [MS Visual Studio 2012 Shell Integrated][]
- [Windows Installer XML Toolset - WIX 4.0][WIX]

Установить необходимо все пакеты в указанном порядке. В результате - получае MS Visual Studio 2012 с подготовленными
шаблонами проектов WiX. После этого открываем файл решения `.sln` и собираем решение.

Варианты пакетов
----------------

### Административная точка установки

В папке `bin\Admin image\x86\ru-RU` собран проект, подготовленный к роли административной точки установки.
В нём отсутствует интерфейс пользователя.

### .msi пакет в виде единого файла

В папке `bin\Single .msi file\x86\ru-RU` собран .msi пакет в виде единого файла.
В отличии от предыдущего варианта, в данной редакции присутствует интерфейс пользователя,
позволяющий изменить и состав продукта, и папку его установки.

При необходимости создания административной точки установки с интерфейсом пользователя следует воспользоваться
командной строкой по следующему примеру:

    msiexec -a "bin\Single .msi file\x86\ru-RU\sapsan2.msi" TARGETDIR="adm\x86"

Подготовка административной точки установки
-------------------------------------------

При подготовке административной точки установки доступны к изменении нижеописанные свойства.

### DONTUNINSTALLORIGINALPACKAGE

При установке данного свойства ("Yes") деинсталляция приложений, установленных оригинальными инсталляторами,
осуществляться не будет. По умолчанию данный пакет обнаруживает и деинсталлирует приложения, установленные
оригинальными инсталляторами.

### DISABLESHORTCUTS

По умолчанию - `"No"`. При установке значения `"Yes"` при установке не будут опубликованы ярлыки.
Для данного пакета использование данного флага не рекомендуется.

### DISABLEDESKTOPSHORTCUTS

По умолчанию - `"No"`. При установке значения `"Yes"` при установке не будут опубликованы ярлыки на рабочем столе.
При `DISABLESHORTCUTS="Yes"` значение данного свойства роли не играет.

### DISABLEMENUSHORTCUTS

По умолчанию - `"No"`. При установке значения `"Yes"` при установке не будут опубликованы ярлыки в меню.
При `DISABLESHORTCUTS="Yes"` значение данного свойства роли не играет.

### APPLICATIONFOLDER

Путь к папке, в которую будет установлен программный продукт.
Устанавливать в качестве значения данного свойства требуется только путь по отношению к `%ProgramFiles%`.

### Примеры

Несколько примеров подготовки административной точки установки:

	msiexec -a sapsan2.msi DISABLEDESKTOPSHORTCUTS=Yes ALLUSERS=0

Данная командная строка готовит точку установки с "отключенными" ярлыками рабочего стола, с установкой приложения для пользователя
(а не для компьютера).

	msiexec -a sapsan2.msi DISABLESHORTCUTS=Yes

Данная командная строка готовит точку установки с "отключенными" ярлыками.

Особенности эксплуатации программного продукта
----------------------------------------------

Данный дистрибутив регистрирует следующие типы файлов и ProgId для них:

- `.shl` - шаблон протокола поверки измерителей скорости для модуля Сапсан 2-10М. ProgId - `shlfile`.
- `.rhl` - шаблон протокола поверки измерителей скорости для модуля Сапсан 2-24М. ProgId - `rhlfile`.
- `.prt` - протокол поверки измерителей скорости для обоих модулей. ProgId - `prtfile`.

Для соответствующих веток реестра в `HKCR` предоставлены права на запись локальной группе безопасности "Пользователи",
так ка приложения при запуске пытается осуществить запись в данные ветки, и в случае неудачи - завершается с ошибкой.

При сохранении файлов `.shl` и `.rhl` следует помнить о том, что приложение не поддерживает пробелы в полном имени файла.
Поэтому рекомендую использовать папку на общем / личном сетевом диске типа "H:\Сапсан2\".


[Сапсан 2]: http://www.olvia.ru/rus/products.php?s=9
[MS Visual Studio 2012 Shell Isolated]: http://www.microsoft.com/ru-ru/download/details.aspx?id=30670
[MS Visual Studio 2012 Shell Integrated]: http://www.microsoft.com/ru-ru/download/details.aspx?id=30663
[WIX]: http://wixtoolset.org/
